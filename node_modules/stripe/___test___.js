

var async = require('async');

var stripe = require('./lib/stripe')();
// local = sk_test_uGCobEeYAQPjGYlGuZORD5PV
//stripe.setHost('127.0.0.1', 15003, 'http');



stripe.charges.create({
  amount: 50,
  currency: 'gbp',
  card: 'tok_14NjUU2LB05yhRz26YBYCXwe'
}, 'sk_live_20kiZn2UFkT1lKr1KUGA1MmG').then(function(a) {
  console.log('omg yay', a);
}, function(err) {
  console.log('omg no', err);
});


// async.each(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'k'], function(item, cb) {
//   stripe.customers.create({
//     description: 'Some customer ' + item,
//     card: {
//       number: '4242424242424242',
//       exp_month: 12,
//       exp_year: 2015,
//       cvc: '123'
//     },
//     //expand: ['default_card']
//   }).then(function(s) {
//     // Success
//     console.log('>',s)
//     cb();
//   }, function(err) {
//     console.log('!', err)
//   });
// }, function() {
//   console.log('OMGOMG');
// });


// var https = require('https');
// var http = require('http');

// var tls = require('tls');


// // cleartextStream = tls.connect({
// //   host: 'stripe.com',
// //   port: 443
// // }, function() {
// //   console.log('SOMETHING?', cleartextStream.getPeerCertificate());
// // });
// // cleartextStream.setEncoding('utf8');
// // cleartextStream.on('data', function(data) {
// //   console.log(data);
// // });
// // cleartextStream.on('secureConnect', function(data) {
// //   console.log('secureConnect');
// // });
// // cleartextStream.on('end', function() {
// //   server.close();
// // });



// req = https.request({
//   host: 'stripe.com',
//   // port: '443',
//   path: '/',
//   method: 'GET',
//   headers: {}
// });

// req.setTimeout(5000, function() {
//   console.log('Timeout!');
// });
// req.on('response', function(res) {
//   var response = '';
//   res.setEncoding('utf8');
//   console.log('OOOOOO', res.connection.getPeerCertificate())
//   res.on('data', function(chunk) {
//     response += chunk;
//   });
//   res.on('end', function() {
//     console.log('Res', response);
//   });
// });
// req.on('error', function(err) {
//   console.log('Err', err);
// });
// req.on('socket', function(s) {
//   console.log('Connect', s.getPeerCertificate());
//   s.on('secureConnect', function(b) {
//     console.log('OMGCoAnother', s.getPeerCertificate());
//   })
// });

// // req.write(requestData,);
// req.end();